<div class="container-fluid" ng-controller="PullRequestsController">
    <div class="row">
        <div class="col-lg-12 sub-nav">
            <select class="form-control" ng-model="SelectedProject" ng-change="UpdateSelectedProject()">
                <option  ng-repeat="project in projects" value="{{project.id}}">{{project.name}}</option>
            </select>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-4 visible-lg"></div>
        <div class="col-lg-2 visible-lg">
            <b>Developer</b>
        </div>
        <div class="col-lg-6 visible-lg">
            <b>Reviewers</b>
        </div>
    </div>
    <div id="Loading" ng-if="IsLoading">
        <div class="loader"></div>
    </div>
    <div ng-if="!IsLoading">
        <div ng-if="pullRequests.length == 0">No Pull Requests.</div>

        <div class="row striped pullRequest" ng-repeat="pr in pullRequests">
            <div class="col-lg-4 col-md-12" style="padding:5px">
                <b>Created: {{pr.creationDate | date : "MM/dd/yyyy h:mm a"}}</b>
                <span class="prID" style="visibility: hidden">{{pr.pullRequestId}}</span>
                <span class="prTitle" style="visibility: hidden">{{pr.title}}</span>
                <h3>
                    <a href="{{pr.remoteUrl}}" target="_blank">{{pr.title}}</a>
                </h3>
                <h5>
                    <a href="{{pr.repository.project.remoteUrl}}" target="_blank">{{pr.repository.project.name}}</a>
                    /<a href="{{pr.repository.remoteUrl}}" target="_blank">{{pr.repository.name}}</a>
                    | [Merge Status: <span ng-bind-html="pr.mergeStatus | mergeStatus"></span>]
                </h5>
                <div>
                    <span ng-if="RequiresBuilds(pr)">Build Status: 
                        <span ng-if="!pr.build" class="glyphicon glyphicon-remove" style="color: red">No Build Queued</span>
                        <a href="{{pr.build._links.web.href}}" target="_blank">
                            <span ng-if="pr.build.status == 'inProgresss'" class="glyphicon glyphicon-plane" style="color: blue"> In Progress</span>
                            <span ng-if="pr.build.status == 'notStarted'" class="glyphicon glyphicon-plane" style="color: gray"> Not Started</span>
                            <span ng-if="pr.build.status == 'completed'" ng-switch="pr.build.result">
                                <i ng-switch-when="succeeded" class="glyphicon glyphicon-check" style="color: green">Completed</i>
                                <i ng-switch-when="failed" class="glyphicon glyphicon-remove" style="color: red">Failed</i>
                                <i ng-switch-default>{{pr.build.result}}</i>
                            </span>
                        </a>
                    </span><br/>
                    <span ng-if="GetRequiredReviewerCount(pr)">Required Reviewers:<span ng-switch="HasEnoughReviewers(pr)"><i ng-switch-when="true" class="glyphicon glyphicon-check" style="color:green"></i><i ng-switch-when="false" class="glyphicon glyphicon-remove" style="color:red"></i></span> {{getReviewersCount(pr)}} of {{GetRequiredReviewerCount(pr)}}</span>   
                </div>
            </div>
            <div class="col-lg-2 padding col-md-12">
                <div class="media">
                    <div class="media-left"><img class="media-object" ng-src="{{pr.createdBy.imageUrl}}" alt="User Photo" height="50" width="50"></div>
                    <div class="media-body">
                        <h5 class="media-heading">
                            {{pr.createdBy.displayName}}
                        </h5>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-md-12 padding">
                <div ng-repeat="reviewer in pr.reviewers | filter : {isContainer: false} ">
                    <div class="media">
                        <div class="media-left"><img class="media-object" ng-src="{{reviewer.imageUrl}}" alt="User Photo" height="50" width="50"></div>
                        <div class="media-body">
                            <span ng-bind-html="reviewer | voteStatus"></span>
                        </div>
                    </div>
                
                </div>
            </div>
        </div>
    </div>
</div>